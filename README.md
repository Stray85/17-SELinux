Стенд с Vagrant c SELinux

Цель домашнего задания

Диагностировать проблемы и модифицировать политики SELinux для корректной работы приложений, если это требуется.
Описание домашнего задания
1. Запустить nginx на нестандартном порту 3-мя разными способами:
● переключатели setsebool;
● добавление нестандартного порта в имеющийся тип;
● формирование и установка модуля SELinux.

Описание и команды:

Разрешим в SELinux работу nginx на порту TCP 4881 c помощью переключателей setsebool:
setsebool -P nis_enabled on

Теперь разрешим в SELinux работу nginx на порту TCP 4881 c помощью добавления нестандартного порта в имеющийся тип:

semanage port -a -t http_port_t -p tcp 4881

Разрешим в SELinux работу nginx на порту TCP 4881 c помощью формирования и установки модуля SELinux:

grep nginx /var/log/audit/audit.log | audit2allow -M nginx

semodule -i nginx.pp

################################################

2. Обеспечить работоспособность приложения при включенном selinux.
SELinux: проблема с удаленным обновлением зоны DNS

Инженер настроил следующую схему:

- ns01 - DNS-сервер (192.168.50.10);
- client - клиентская рабочая станция (192.168.50.15).

При попытке удаленно (с рабочей станции) внести изменения в зону ddns.lab происходит следующее:
```bash
[vagrant@client ~]$ nsupdate -k /etc/named.zonetransfer.key
> server 192.168.50.10
> zone ddns.lab
> update add www.ddns.lab. 60 A 192.168.50.15
> send
update failed: SERVFAIL
>
```
Инженер перепроверил содержимое конфигурационных файлов и, убедившись, что с ними всё в порядке, предположил, что данная ошибка связана с SELinux.

В данной работе предлагается разобраться с возникшей ситуацией.


#### Задание

- Выяснить причину неработоспособности механизма обновления зоны.
- Предложить решение (или решения) для данной проблемы.
- Выбрать одно из решений для реализации, предварительно обосновав выбор.
- Реализовать выбранное решение и продемонстрировать его работоспособность.


#### Формат

- README с анализом причины неработоспособности, возможными способами решения и обоснованием выбора одного из них.
- Исправленный стенд или демонстрация работоспособной системы скриншотами и описанием.


Команды:
Изменим тип контекста безопасности для каталога /etc/named на сервере ns01: 
sudo chcon -R -t named_zone_t /etc/named
Посмотрим изменения:
ls -laZ /etc/named
Вносим изменения с клиента:
nsupdate -k /etc/named.zonetransfer.key
> server 192.168.50.10
> zone ddns.lab
> update add www.ddns.lab. 60 A 192.168.50.15
> send
> quit
 dig www.ddns.lab
 Видим, что изменения применились. Попробуем перезагрузить хосты и ещё раз сделать запрос с помощью dig:
dig @192.168.50.10 www.ddns.lab

Всё работает.